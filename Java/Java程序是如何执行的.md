#### Java 程序是如何执行的？

```java
public class Test {
	public static void main(String[] args) {
		for(String str:args) {
			System.out.println(str);
		}
	}
}
```

上面一段```Java``` 程序是如何执行的呢？

#### 1. Java 虚拟机启动

传递一个字符串数组作为参数，```Java``` 虚拟机通过调用指定类的 ```main``` 函数开始执行。

命令行需要指定类的全限定类名，进行编译和运行，不过在本例中，```Test```类并不在具体的某一个包中，直接在当前目录中编译运行即可。

编译命令：```javac Test.java```，该命令会生成 ```.class``` 文件。

运行命令：``` java Test reboot Bob Dot Enzo```，``` reboot Bob Dot Enzo``` 为传递给 ``` main ```函数的参数。

```Java``` 虚拟机要运行 ```Test```类，需要进行**加载**、**连接**、**初始化**操作。

#### 1.1 加载 Test 类

最初尝试执行```Test``` 类的 ```main``` 函数时发现 ```Test``` 类没有被加载，也就是 ```Java``` 虚拟机没有包含该类的二进制表示。此时```Java```虚拟机将会使用类加载器试图寻找这个类的二进制表示，如果这个过程中寻找失败，将会抛出错误。

#### 1.2 连接 Test 类：校验，准备，解析（可选）

在 ```Test``` 类加载完成后，```main``` 函数运行前```Test``` 类必须被初始化，在初始化前必须被连接。连接包括校验，准备，和可选的解析。

校验过程使用恰当的符号表来检查已加载的```Test``` 类的表示是否是结构良好的，同时也会检查是否符合```Java```语言和```Java```虚拟机的语义需要，若在校验过程中出现任何问题，将会抛出错误。

准备过程包括静态空间和和任何被使用的数据结构的空间分配。

解析过程检查从```Test ```类到其他类的符号引用，加载被引用的类并检查引用是否正确。解析步骤在初始连接阶段是可选的。

#### 1.3 初始化 Test类：执行初始化

只有当```Test``` 类已经完成初始化，```Java``` 虚拟机才被允许执行 ```Test```类的 ```main``` 方法。

初始化以文字顺序来执行类变量以及静态变量的初始化。在```Test``` 类初始化关，它的直接父类必须被初始化，它的直接父类的父类一直向上初始化。上例为最简单的例子，```Test``` 类的隐式直接父类是 ```Object```，所以在```Test``` 类初始化前，```Object```类必须 要被初始化。

若Test 类有其他父类，其父类必须要在```Test``` 类初始化前进行初始化，这个过程同样需要加载、校验、准备。

初始化过程中若其子过程出现加载、连接、初始化错误，将会抛出错误。

#### 1.4 执行 Test.main

最后，完成```Test``` 类的初始化后，```Test ```类的 ```main``` 方法终于可以被执行了。

```main ```方法必须以``` public``` , ```static```, 和 ```void``` 声明。它必须指定一个正式的参数。以下两种都是可接受的：

```java
public static void main(String[] args)
```

```java
public static void main(String... args)
```

